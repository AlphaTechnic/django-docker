server {
  listen                80;
  server_name           ~.;
  charset               utf-8;
  client_max_body_size  128M;

  if ($host !~* ^([\w\d]+\.)?(pickk.xyz)$ ) {
    return 444;
  }

  location / {
    uwsgi_pass           unix:///tmp/pickk-biz.sock;
      include              uwsgi_params;
  }

  location /static/ {
    alias               '/var/www/pickk-biz/static/';
  }

  location /media/ {
    alias               /home/ubuntu/srv/pickk-biz/media/;
  }

  location /flower/static/ {
    alias  /home/ubuntu/.pyenv/versions/production/lib/python3.7/site-packages/flower/static/;
  }

  location /flower/ {
    rewrite ^/flower/(.*)$ /$1 break;
    proxy_pass http://127.0.0.1:5555;
      proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header Host $host;
  }

  set $item_info_crawler_domain 'https://crawl.pickk.one/';

    location /item-info-crawl/ {
      rewrite ^/item-info-crawl/(.*)$ $item_info_crawler_domain/$1 redirect;
    }
}

server {
  listen                119;
  server_name           ~.;

  location / {
    return 444;
  }

  location /ping/ {
    proxy_pass  http://127.0.0.1:80/ping/;
    proxy_set_header Host pickk.xyz;
  }
}